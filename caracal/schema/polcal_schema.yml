type: map
mapping:
  polcal:
    type: map
    desc: Carry out polarization calibration of the data (leakage and polarized angle).
    mapping:
      enable:
        desc: Execute the polcal worker.
        type: bool
        required: false
        example: 'True'
      label_in:
        desc: Label of the .MS file(s) to work on.
        type: str
        required: false
        example: 'cal'
      label_cal:
        desc: Label for output files (calibration tables, images).
        type: str
        required: false
        example: '1pcal'
      otfcal:
        desc: Apply on-the-fly (OTF) calibration.
        type: map
        mapping:
          enable:
            desc: Enable the 'otfcal' segment.
            type: bool
            required: false
            example: 'False'
          callib:
            desc: Name of the callib file to be used, if user has their own. A corresponding .json file must exist.
            type: str
            required: false
            example: ''
          label_cal:
            desc: Label of the calibration tables to be used.
            type: str
            required: false
            example: ''
      feed_angle_rotation:
        desc: Set the rotation angle for feeds. For MeerKAT data it is suggested to rotate the feeds by -90 degrees to agree with the convention assumed in the CASA software which is used to do the polarization calibration. Leave it empty if you don't want to rotate the feeds.
        type: str
        required: false
        example: ''
      uvrange:
        desc: Select what UV range should be used throughout this worker following the CASA notation (e.g., ">100"). The default units are metres but other units can be used (e.g., ">0.5klambda").
        type: str
        required: false
        example: '>50'
      reuse_existing_tables:
        desc: Use existing pcal tables
        type: bool
        required: false
        example: "True"
      pol_calib:
        desc: calibrator for the polarized angle
        type: str
        required: false
        example: xcal
      leakage_calib:
        desc: leakage calibrator. It could be either a known unpolarized calibrator or a polarized calibrator observed at several parallactic angles
        type: str
        required: false
        example: xcal
      timesol_solfreqsel:
        type: str
        required: false
        desc: Subband selection to be used whenever solving for the DC component of either X or D. This could be picked to avoid RFI.
        example: ''
      timesol_soltime:
        type: str
        required: false
        desc: Time solution interval to be used whenever solving for the DC component of either X or D
        example: 'inf'
      freqsol_soltime:
        type: str
        required: false
        desc: Time solution interval to be used when solving for per channel solutions for either X or D. This ought to be as long as possible
        example: 'inf'
      plotgains:
        desc: Plot solutions with ragavi-gains. The .html plots are located in <output>/diagnostic_plots/polcal/.
        type: bool
        required: false
        example: "True"
      apply_pcal:
        desc: Apply the polcal solutions to the cross calibrated corrected MS. If this is set to 'False' the cross calibrated MS will be deleted.
        type: bool
        required: false
        example: 'True'
      applyto:
        seq:
          - type: str
        desc: Fields to apply calibration to.
        required: false
        example: "xcal, bpcal, gcal, target"
      cabs:
        desc: 'Specifies non-default image versions and/or tags for Stimela cabs. Running with scissors: use with extreme caution.'
        required: false
        seq:
          - type: map
            mapping:
              name:
                type: str
                required: true
                example: 'cabname'
              version:
                type: str
                required: false
                example: ''
              tag:
                type: str
                required: false
                example: ''
        example: ''
      report:
        type: bool
        required: false
        desc: (Re)generate a full HTML report at the end of this worker.
        example: 'False'