type: map
mapping:
  polcal:
    type: map
    desc: Carry out polarization calibration of the data (leakage and polarized angle).
    mapping:
      enable:
        desc: Execute the polcal worker.
        type: bool
        required: false
        example: 'True'
      label_in:
        desc: Label of the .MS file(s) to work on.
        type: str
        required: false
        example: 'cal'
      crosscal_callib:
        desc: Label of the cross cal tables to be applied. If empty it assumes that we are starting from a splitted cross calibrated MS, otherwise it applies the cross_cal solutions and split the MS to look for polcal solutions. Please, write the full json file name.
        type: str
        required: false
        example: ''
      label_cal:
        desc: Label for output files (calibration tables, images).
        type: str
        required: false
        example: '1pcal'
      feed_angle_rotation:
        desc: Set the rotation angle for feeds. For MeerKAT data it is suggested to rotate the feeds by -90 degrees to agree with the convention assumed in the CASA software which is used to do the polarization calibration. Leave it empty if you don't want to rotate the feeds.
        type: str
        required: false
        example: ''
      uvrange:
        desc: Select what UV range should be used throughout this worker following the CASA notation (e.g., ">100"). The default units are metres but other units can be used (e.g., ">0.5klambda").
        type: str
        required: false
        example: '>50'
      reuse_existing_tables:
        desc: Use existing pcal tables
        type: bool
        required: false
        example: "True"
      pol_calib:
        desc: calibrator for the polarized angle
        type: str
        required: false
        example: xcal
      leakage_calib:
        desc: leakage calibrator. It could be either a known unpolarized calibrator or a polarized calibrator observed at several parallactic angles
        type: str
        required: false
        example: xcal
      avg_bw:
        desc: set the bandwidth average interval to increase SNR.
        type: str
        required: false
        example: '1MHz'
      make_checking_plots:
        desc: Plot solutions and save in <output>/diagnostic_plots/polcal/.
        type: bool
        required: false
        example: "True"
      refant_for_plots:
        desc: Reference antenna for plots.
        type: str
        required: false
        example: 'm007'
      apply_pcal:
        desc: Apply the polcal solutions to the cross calibrated corrected MS. If this is set to 'False' the cross calibrated MS will be deleted.
        type: bool
        required: false
        example: 'True'
      applyto:
        seq:
          - type: str
        desc: Fields to apply calibration to.
        required: false
        example: "xcal, bpcal, gcal, target"
      cabs:
        desc: 'Specifies non-default image versions and/or tags for Stimela cabs. Running with scissors: use with extreme caution.'
        required: false
        seq:
          - type: map
            mapping:
              name:
                type: str
                required: true
                example: 'cabname'
              version:
                type: str
                required: false
                example: ''
              tag:
                type: str
                required: false
                example: ''
        example: ''
      report:
        type: bool
        required: false
        desc: (Re)generate a full HTML report at the end of this worker.
        example: 'False'