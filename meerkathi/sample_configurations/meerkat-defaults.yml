schema_version: 0.2.0

general:
  msdir: msdir
  input: input
  output: output
  prefix: mypipelinerun
  init_pipeline: true


get_data:
  dataid: []

observation_config: 
  obsinfo: 
    enable: true
  target:
    - 'all'
  gcal: 
    - 'all'
  bpcal:
    - 'longest'
  fcal:
    - 'longest'
  xcal:
    - 'longest'
  reference_antenna: '0'

prepare_data: 
  enable: true
  fixvis: 
    enable: false
  manage_flags: 
    mode: restore
    version: caracal_legacy
  clear_cal: true
  spectral_weights:
    mode: uniform

flagging:
  enable: true
  label: ''
  flag_autocorr:
    enable: true
  flag_spw:
    enable: true
    channels: '*:856~880MHz , *:1658~1800MHz, *:1419.8~1421.3MHz'
    ensure_valid_selection: false
  flag_antennas:
    enable: false
    antennas: '0'
  flag_scan:
    enable: false
    scans: '0'
  static_mask:
    enable: true
    mask: labelled_rfimask.pickle.npy
    uvrange: '0~1000'
  autoflag_rfi:
    enable: true
    flagger: aoflagger
    strategy: firstpass_QUV.rfis
  rfinder:
    enable: false
    telescope: MeerKAT
    field: target

cross_cal:
  enable: true
  otfdelay: true
  uvrange: '>150'
  label: 1gc1
  load_flags:
    flag_version: after_flagging_automatic
    merge: False
  set_model:
    enable: true
    meerkathi_model: true
  primary_cal:
    enable: true
    reuse_existing_gains: true
    order: KGBAKGB
    combine: ["", "", "", null, "","", scan]
    solint: [inf, inf, inf, null, 60s, 60s, inf]
    calmode: [a, ap, ap, null, a, ap, ap] 
    B_fillgaps: 70
    plotgains: true
  secondary_cal:
    enable: true
    reuse_existing_gains: true
    order: KGAKG
    apply: B
    combine: ["", "", null, "", ""] 
    solint: [inf, inf, null, inf, inf]
    calmode: [a, ap, null, a, ap] 
    plotgains: true
  apply_cal: 
    enable: true
    applyto: 
      - gcal
      - bpcal
      - target

polcal: 
  enable: false

inspect_data: 
  enable: true
  label: '1gc'
  fields:
    - bpcal
    - gcal
  real_imag: 
    enable: true
    avgtime: '60'
  amp_phase: 
    enable: true
    avgtime: '60'
  amp_uvwave: 
    enable: true
    avgtime: '60'
  amp_ant: 
    enable: true
    avgtime: '60'
  phase_uvwave: 
    enable: true
    avgtime: '60'
  amp_scan: 
    enable: true
    avgtime: '60'

split_target: 
  enable: true
  label_in: ''
  label_out: corr
  split_target: 
    enable: true
    time_average: ''
    freq_average: 1
    column: corrected
    correlation: ''
    spw: ''
    otfcal: 
      enable: false
  obsinfo: 
    enable: true
    listobs: false

flagging__2: 
  enable: true
  label: corr
  autoflag_rfi: 
    enable: true
    flagger: aoflagger
    strategy: firstpass_QUV.rfis
    column: DATA
  rfinder: 
    enable: false
    field: target

masking: 
  enable: false
  centre_coord:
    - HH:MM:SS
    - DD:MM:SS
  label: corr

self_cal:
  enable: true
  img_npix: 4096
  img_cell: 1.3
  image:
    enable: true
  calibrate:
    enable: true
    Gsols_time: [120]

image_line:
  enable: true
  restfreq: '1.420405752GHz'
  make_cube:
    enable: true
    npix: [1800]
    cell: 2
  mstransform:
    enable: true
    telescope: meerkat
