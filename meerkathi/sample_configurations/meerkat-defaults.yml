schema_version: 0.2.0

general:
  msdir: msdir
  input: input
  output: output
  prefix: mypipelinerun
  init_pipeline: true


get_data:
  dataid: []

observation_config: 
  obsinfo: 
    enable: true
  target: auto
  gcal: auto
  bpcal: auto
  fcal: auto
  xcal: auto
  reference_antenna: '0'
  primary_beam: 
    enable: false

prepare_data: 
  enable: true
  fixvis: 
    enable: false
  manage_flags: 
    enable: true
  add_spectral_weights: 
    enable: false
  clear_cal: true

flagging:
  enable: true
  label: ''
  quack_flagging:
    enable: false
  flag_spw:
    enable: true
    channels: '*:856~880MHz , *:1658~1800MHz, *:1419.8~1421.3MHz'
    ensure_valid_selection: false #TODO(Paolo, I think) this is not working
  flag_antennas:
    enable: false
    antennas: '0'
  flag_scan:
    enable: false
    scans: '0'
  static_mask:
    enable: true
    mask: labelled_rfimask.pickle.npy
    uvrange: '0~1000'
  autoflag_rfi:
    enable: true
    flagger: aoflagger
    strategy: firstpass_QUV.rfis
  rfinder:
    enable: false
    telescope: MeerKAT
    field: target

cross_cal:
  enable: true
  otfdelay: true
  uvrange: '>150'
  label: 1gc1
  set_model:
    enable: true
  primary_cal:
    enable: true
    order: KGBKGB
    combine: ["", "", "", "","", scan]
    solint: [inf, inf, inf, 60s, 60s, inf]
    calmode: [a, ap, ap, a, ap, ap] 
    B_fillgaps: 70
    plotgains: true
  secondary_cal:
    enable: true
    order: KG
    apply: B
    combine: ["", "", "", ""] 
    solint: [inf, inf, 120s, 120s]
    calmode: [a, ap, a, ap] 
    plotgains: true
  apply_cal: 
    enable: true
    applyto: 
      - gcal
      - bpcal
      - target

polcal: 
  enable: false

inspect_data: 
  enable: true
  label: '1gc'
  fields:
    - bpcal
    - gcal
  real_imag: 
    enable: true
    avgtime: '60'
  amp_phase: 
    enable: true
    avgtime: '60'
  amp_uvwave: 
    enable: true
    avgtime: '60'
  amp_ant: 
    enable: true
    avgtime: '60'
  phase_uvwave: 
    enable: true
    avgtime: '60'
  amp_scan: 
    enable: true
    avgtime: '60'

split_target: 
  enable: true
  label_in: ''
  label_out: corr
  split_target: 
    enable: true
    time_average: ''
    freq_average: 1
    column: corrected
    correlation: ''
    spw: ''
    otfcal: 
      enable: false
  obsinfo: 
    enable: true
    listobs: false

flagging__2: 
  enable: true
  label: corr
  autoflag_rfi: 
    enable: true
    flagger: aoflagger
    strategy: firstpass_QUV.rfis
    column: DATA
  rfinder: 
    enable: false
    field: target

masking: 
  enable: false
  centre_coord:
    - HH:MM:SS
    - DD:MM:SS
  label: corr

self_cal: 
  enable: true
  label: corr

image_HI: 
  enable: true
  label: corr
