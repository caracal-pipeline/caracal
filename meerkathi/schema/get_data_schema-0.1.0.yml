type: map
mapping:
  schema_version:
    type: str
    required: True

  get_data:
    type: map
    desc: Download and/or convert/unarchive data so that its in the MS format for further processing
    mapping:
      dataid:
        seq:
          - type: str
        required: False
        desc: Basename of MS. For MeerKAT data to be downloaded by MeerKATHI, this should be the data ID of the observation
        example: ['mydata']

      mvftoms:
        type: map
        desc: Convert HDF5/MVF files in data_path to MS files; the latter are written to msdir; also creates a MS.TAR file. (This only works for MeerKAT HDF5 files)
        mapping:
          enable:
            type: bool
            desc: Execute this segment
            required: True
            example: 'False'
          tar: 
            type: bool
            desc: Create a tarbal of the converted MS.
            required: False
            example: 'False'
          channel_range:
            type: str
            desc: Only exctract channels in this range (0-based, inclusive; comma seperated string)
            required: False
            example: all
          full_poll:
            type: bool
            desc: Extract all four correlations instead of only the XX,YY
            required: False
            example: 'False'

      untar:
        type: map
        desc: Unarchive from MS from a archive file.
        mapping:
          enable:
            type: bool
            desc: Execute this segment
            required: True
            example: 'False'
          tar_options: 
            type: str
            desc: Options to parse to 'tar' command
            required: False
            example: '-xvf'

      combine:
        desc: Virtually concatenate MSs and proceed with the combined MS
        type: map
        mapping:
          enable:
            type: bool
            desc: Execute this section
            required: True
            example: 'False'
          reset:
            type: bool
            desc: Delete concatenated MS if it exists. Else, proceed with existing MS
            required: False
            example: 'False'
          tar:
            desc: Create a tarbal of the converted MS
            type: map
            mapping:
              enable: 
                desc: Execute this section
                type: bool
                required: False
                example: 'False'
              tar_options:
                type: str
                desc: Options to parse to the tar command
                required: False 
                example: 'False'

          untar:
            desc: Unarchive from MS from a archive file.
            type: map
            mapping:
              enable: 
                desc: Execute this section
                type: bool
                required: False
                example: 'False'
              tar_options:
                type: str
                desc: Options to parse to the tar command
                required: False
                example: '-xvf'
