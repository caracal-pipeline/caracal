type: map
mapping:
  schema_version:
    type: str
    required: true

  split_target:
    desc: Split and average target data
    type: map
    mapping:
      enable:
        desc: Execute this worker
        type: bool
        required: true
        example: 'False' 
      label_in:
        desc: Label of the input dataset
        type: str
        required: true
        example: corr
      label_out:
        desc: Label of the output dataset
        type: str
        required: true
        example: corr 

      split_target:
        desc: Split data
        type: map
        mapping:
          enable:
            desc: Execute this section
            type: bool
            required: true
            example: 'False'
          time_average:
            desc: Time averaging
            type: str
            required: true
            example: '10s'
          freq_average:
            desc: Frequency averaging
            type: int
            required: true
            example: "10"
          column:
            desc: Column to split, default is 'corrected'
            type: str
            required: false
            example: 'CORRECTED'
          correlation:
            desc: Select correlations, default is '' = all
            type: str
            required: false
            example: 'all'
          spw:
            desc: Select spectral windows and channels, default is '' = all
            type: str
            required: false
            example: 'all'

          otfcal:
            desc: Apply OTF calibration
            type: map
            mapping:
              enable:
                desc: Execute this section
                type: bool
                required: true
                example: 'False'
              callabel:
                desc: Label of calibration tables to be used
                type: str
                required: true
                example: 'corr'

              apply_delay_cal:
                type: map
                desc: Apply the delay correction calibration table to specified fields via the CASA applycal task.
                mapping: 
                  enable: 
                    desc: Executes application of delay correction calibration table.
                    type: bool
                    required: true
                    example: 'False'
                  field: 
                    seq: 
                      - type: str 
                    desc: Field to select in the delay correction calibration table. Specify either the field number, name or as corrsponding to field spec in observation config, e.g. 'bpcal'.             
                    example: '1'
              
              apply_bp_cal:
                type: map
                desc: Apply the bandpass table to specified fields via the CASA applycal task.
                mapping:
                  enable:
                    type: bool
                    desc: Executes application of bandpass table.
                    required: true
                    example: 'False'
                  field:
                    seq: 
                      - type: str 
                    desc: Field to select in the bandpass table. Specify either the field number, name or as corrsponding to field spec in observation config, e.g. 'bpcal'.
                    example: '1'

              apply_gain_cal_gain:    
                type: map
                desc: Apply the gain calibration table to specified fields via the CASA applycal task.
                mapping:
                  enable:
                    type: bool
                    desc: Executes application of gain calibration table.
                    required: true
                    example: 'False'
                  field:
                    seq: 
                      - type: str 
                    desc: Field to select in the gain calibration table. Specify either the field number, name or as corrsponding to field spec in observation config, e.g. 'gcal'.
                    example: '1'

              apply_transfer_fluxscale:
                type: map
                desc: Apply the fluxscale table to specified fields via the CASA applycal task.
                mapping:
                  enable:
                    type: bool
                    desc: Executes application of fluxscale table.
                    required: true
                    example: 'False'
                  field:
                    seq: 
                      - type: str 
                    desc: Field to select in the fluxscale table. Specify either the field number, name or as corrsponding to field spec in observation config, e.g. 'gcal'.
                    required: false
                    example: '1'

      changecentre:
        desc: changes the phase centre
        type: map
        mapping:
          enable:
            desc: Execute this section
            type: bool
            required: true
            example: "False"
          ra:
            desc: J2000 RA of new phase centre, format XXhXXmXX.XXs, default is empty string
            type: str
            required: true
            example: 'XXhXXmXX.XXs'
          dec:
            desc: J2000 Dec of new phase centre, format XXdXXmXX.XXs, default is empty string
            type: str
            required: true
            example: 'XXdXXmXX.XXs'

      obsinfo:
        desc: Get observation information
        type: map
        mapping:
          enable:
            desc: Execute this section
            type: bool
            required: true
            example: 'False'
          listobs:
            desc: Run CASA listobs
            type: bool
            required: true
            example: 'False'
          summary_json:
            desc: Run MSUtils function
            type: bool
            required: true
            example: 'False'

      prepms:
        desc: Run MSUtils prepms function
        type: map
        mapping:
          enable:
            desc: Run this section
            type: bool
            required: true
            example: 'False'